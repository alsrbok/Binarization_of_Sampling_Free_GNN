Namespace(K=5, acc_loss='acc', aggr_gpu=-1, alpha=0.5, attn_drop=0.4, avoid_features=False, batch_size=50000, chunks=1, data_dir='/home/data/pyg/', dataset='ogbn-products', dropout=0.5, emb_path='/home/scx/NARS/', epoch_setting=[1000], eval_batch_size=100000, eval_every=10, example_subsets_path='/home/scx/NARS/sample_relation_subsets/examples', fixed_subsets=False, focal='first', gpu=0, inductive=False, input_drop=0.2, label_K=9, label_drop=0.5, label_mlp_layer=4, label_residual=False, load_embs=False, load_label_emb=False, lr=0.001, mag_emb=False, memory_efficient=False, mlp_layer=2, model='sagn', num_heads=1, num_hidden=512, num_runs=10, position_emb=False, pretrain_model='ComplEx', probs_dir='../intermediate_outputs', sample_size=8, seed=0, threshold=[0.9, 0.9], use_labels=False, use_norm=False, warmup_stage=-1, weight_decay=0.0, weight_style='attention', zero_inits=True)
----------------------------------------------------------------------------------------------------
Run 0 start training
----------------------------------------------------------------------------------------------------
Stage 0 start training
# Nodes: 2449029
# Edges: 123718280
# Train: 196615
# Val: 39323
# Test: 2213091
# Classes: 47
in_feats: 100
Compute neighbor-averaged feats all
Preprocessing costs 15.5788 s
# Params: 2233391
6
[tensor([[ 0.1913, -0.0372, -0.2720,  ...,  0.2838, -0.9842,  1.7060],
        [-0.1173,  0.8157, -0.1419,  ...,  0.4302,  0.5289,  0.6141],
        [-0.1364, -0.0645,  0.1579,  ...,  1.3289, -0.0458, -0.5185],
        ...,
        [ 0.2389,  0.1841,  0.4437,  ..., -0.6888,  0.1229,  0.0721],
        [-0.6955, -0.2505,  0.1024,  ...,  0.6591, -0.2468,  0.3581],
        [-0.0504, -0.2826,  0.1819,  ..., -0.0192,  0.0057,  0.5263]],
       device='cuda:0'), tensor([[-0.0260,  0.0655, -0.0324,  ..., -0.0157, -0.3928,  0.6280],
        [ 0.0763, -0.0638,  0.0512,  ..., -0.0145,  0.0785,  0.8960],
        [-0.1118,  0.0118, -0.0336,  ...,  0.5926, -0.1763,  0.0474],
        ...,
        [ 0.2341,  0.1913,  0.0358,  ..., -0.3646,  0.2298,  0.2808],
        [-0.0387, -0.1449, -0.0451,  ...,  0.3085,  0.2518,  0.4212],
        [-0.0655, -0.1271,  0.3539,  ..., -0.0050,  0.3933,  0.6119]],
       device='cuda:0'), tensor([[ 3.3890e-02,  5.0564e-02, -2.0294e-02,  ..., -3.4377e-02,
         -2.5420e-01,  5.5509e-01],
        [ 6.1209e-02,  1.6313e-02, -1.4398e-02,  ...,  1.6100e-03,
          4.2692e-02,  7.4511e-01],
        [-1.1608e-01,  3.3603e-02, -5.0321e-02,  ...,  3.9134e-01,
         -5.6624e-02,  2.5251e-02],
        ...,
        [ 1.9434e-01,  1.2153e-01, -2.8283e-02,  ..., -2.9973e-01,
          2.8485e-01,  3.1679e-01],
        [-6.4826e-02, -1.1577e-01, -8.9254e-02,  ..., -6.4014e-04,
          1.4614e-01,  3.7832e-01],
        [-6.2697e-02, -6.4620e-02,  2.3922e-01,  ..., -2.0233e-02,
          3.6359e-01,  5.0015e-01]], device='cuda:0'), tensor([[ 0.0292,  0.0650, -0.0389,  ..., -0.0485, -0.2253,  0.5162],
        [ 0.0602,  0.0115, -0.0210,  ..., -0.0098,  0.0500,  0.6546],
        [-0.1157,  0.0274, -0.0583,  ...,  0.3965, -0.0642,  0.0500],
        ...,
        [ 0.1270,  0.1137, -0.0054,  ..., -0.2650,  0.2593,  0.2982],
        [-0.0573, -0.0864, -0.0668,  ..., -0.0171,  0.1672,  0.3762],
        [-0.0746, -0.0573,  0.1599,  ...,  0.0086,  0.3544,  0.4755]],
       device='cuda:0'), tensor([[ 0.0294,  0.0674, -0.0376,  ..., -0.0433, -0.1793,  0.4843],
        [ 0.0499,  0.0169, -0.0232,  ..., -0.0166,  0.0453,  0.5953],
        [-0.1102,  0.0232, -0.0618,  ...,  0.3815, -0.0457,  0.0613],
        ...,
        [ 0.1031,  0.0989, -0.0205,  ..., -0.2436,  0.2690,  0.3093],
        [-0.0519, -0.0724, -0.0575,  ..., -0.0476,  0.1672,  0.3609],
        [-0.0770, -0.0459,  0.1186,  ...,  0.0063,  0.3431,  0.4464]],
       device='cuda:0'), tensor([[ 0.0295,  0.0667, -0.0377,  ..., -0.0381, -0.1481,  0.4601],
        [ 0.0444,  0.0184, -0.0249,  ..., -0.0206,  0.0478,  0.5527],
        [-0.1046,  0.0201, -0.0650,  ...,  0.3838, -0.0390,  0.0714],
        ...,
        [ 0.0712,  0.0899, -0.0167,  ..., -0.2238,  0.2561,  0.3044],
        [-0.0464, -0.0616, -0.0500,  ..., -0.0636,  0.1632,  0.3486],
        [-0.0753, -0.0397,  0.0913,  ...,  0.0044,  0.3301,  0.4295]],
       device='cuda:0')]
torch.Size([50000, 100])
torch.Size([50000, 100])
torch.Size([50000, 100])
torch.Size([50000, 100])
torch.Size([50000, 100])
torch.Size([50000, 100])
